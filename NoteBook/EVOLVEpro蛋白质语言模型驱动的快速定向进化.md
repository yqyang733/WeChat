# EVOLVEpro：蛋白质语言模型驱动的快速定向进化
在生物医学领域，**定向蛋白质进化**是优化蛋白质功能的关键技术，但传统方法面临实验复杂、多属性优化效率低以及局部最优陷阱等挑战。EVOLVEpro作为一种基于**蛋白质语言模型（PLMs）** 和回归模型的**少样本主动学习框架**，成功克服了这些难题，为蛋白质工程带来了革命性突破。  

![](EVOLVEpro蛋白质语言模型驱动的快速定向进化/EVOLVEpro蛋白质语言模型驱动的快速定向进化_2025-01-28-18-48-44.png)  

## 背景
理解**蛋白质氨基酸序列与功能之间的关系**对于推动生物学发展和开发新疗法至关重要。实验方法如深度突变扫描（DMS）**只能探索蛋白质序列空间的一小部分**。同源序列的计算方法可以减少绘制适应度景观和优化蛋白质所需的实验数据，但这些方法需要多序列比对、高同源序列丰度和最小的序列长度变异。

为了克服这些挑战，可以通过在进化多样性上进行广泛训练来推断适应度。蛋白质语言模型（PLMs），如ESM2，通过在全面的蛋白质序列数据库上进行训练来填补缺失的氨基酸。**PLMs学习了用于蛋白质结构预测和功能注释的信息性生物学表征。** 然而，**零样本预测的突变体成功率有限，** 从头设计的蛋白质通常表现出与天然野生型（WT）序列相当或较低的活性。**优化迭代方法，如定向进化（DE），利用蛋白质适应度景观的平滑性来改善功能。** 尽管这些方法在具有合适活性景观和筛选方法的背景下是成功的，但它们可能劳动密集，并且在崎岖的景观中失败，尤其是在陷入局部最优时。  

本文提出的蛋白质进化模型EVOLVEpro通过**主动学习**和**最少的实验测试**提名高活性蛋白质变体，实现快速预测高活性突变体。该方法源于一种模块化方法，**将进化尺度的PLM与顶层回归模型结合，以学习蛋白质的活性景观并指导计算机模拟中的定向进化过程。** EVOLVEpro仅使用蛋白质序列，不需要结构信息、专家知识或先验数据。文中展示了EVOLVEpro**同时进化蛋白质多种活性的能力**，为其在生物学和医学中的应用开辟了广阔的可能性。

## 方法
**（1）使用蛋白质语言模型ESM2嵌入。** 如下图所示，蛋白质语言模型嵌入转换（ESM2-15B）将 $x_i$ 映射为一个嵌入序列，每个氨基酸对应一个嵌入，其中 $d$ 是嵌入空间的维度。为了减少特征数量并获得与蛋白质长度无关的固定大小表示，文中通过取所有氨基酸位置的平均值来计算平均嵌入向量。该向量是一个 $d$ 维向量，其表示整个蛋白质变体，然后将其用作EVOLVEpro的输入。  
![](EVOLVEpro蛋白质语言模型驱动的快速定向进化/EVOLVEpro蛋白质语言模型驱动的快速定向进化_2025-02-01-18-30-23.png)  

**（2）EVOLVEpro 模型信息。** EVOLVEpro 框架中，随机森林回归器被用作顶层模型。随机森林回归器使用先前描述的由蛋白质语言模型生成的信息丰富的潜在空间平均嵌入向量作为输入特征，来预测每个变体的活性或适应性。这种集成学习方法结合多个决策树进行预测，具有抗过拟合的鲁棒性，并且能够捕捉数据中的复杂非线性关系。随机森林模型配置了 100 个估计器（即单个决策树）。使用 Friedman 均方误差（MSE）准则来评估分裂的质量。森林中的每棵树都在原始数据集的自助样本上进行训练。在树的每个节点处，通过最大化杂质减少量来确定最佳分裂。随机森林对新输入的最终预测是所有树的预测值的平均值。    
![](EVOLVEpro蛋白质语言模型驱动的快速定向进化/EVOLVEpro蛋白质语言模型驱动的快速定向进化_2025-02-01-19-54-12.png)  

**主动学习方法。** 在 EVOLVEpro 的每一轮中，在当前数据集上训练随机森林后，文中使用该模型来预测其余未测试蛋白质变体的适应性值。然后，主动学习步骤选择最有潜力的变体用于下一轮的实验测试。  

**选择策略。** 文中探索了各种选择策略，包括选择在欧几里得空间中与训练集距离最远的嵌入向量，以及选择顶部和底部预测值的混合。经测试 top-n 策略是最有效的。top-n 策略是选择具有最高预测适应性值的 n 个变体。该策略旨在迭代地扩展随机森林预测范围的上限。通过关注顶部预测值，文中利用模型当前对嵌入空间中高适应性区域的理解，同时鼓励探索可能产生更好变体的附近区域。虽然这种贪心方法可能会忽略适应度景观的某些区域，但文中认为它与在有限的实验轮次中快速识别和优化高性能蛋白质变体的目标非常契合。  

**（3）数据集。** 为了进行模型基准测试，文中选取了 9 个现有的深度突变扫描（DMS）数据集，这些数据集曾在之前的一种零样本高适应性预测方法中使用。基于这项研究，文中利用每个数据集预先设定的高适应性变体的临界值，来挑选出低适应性和高适应性的变体。这里利用之前研究中既定的临界值，对这 9 个数据集中的变体按适应性高低进行筛选，为后续模型测试做准备。

文中还挑选了另外三个 DMS 数据集：一个与 AsCas12f 紧凑型基因组编辑器相关的数据集、新冠病毒刺突受体结合域相关数据集以及寨卡病毒包膜蛋白相关数据集。对于这些数据集，依据高活性变体的总体分布情况来设定临界值。在已有 9 个数据集基础上，新增 3 个不同类型的数据集，并根据这些新数据集自身高活性变体分布设定临界值，进一步丰富数据来源和类型。  

**（4）EVOLVEpro 参数网格搜索。**   
**适应度测量。** 使用每个数据集的原始适应度值，或者使用最小 - 最大归一化后的适应度值。这一步是在探索如何对适应度数据进行预处理，以找到最有利于模型优化适应性的方式。原始适应度值直接取自数据集，而最小 - 最大归一化是一种常见的数据标准化方法，将数据映射到 [0, 1] 区间，有助于在不同数据集间统一尺度，可能对模型性能产生不同影响。  

**第一轮策略。** 随机选择变体，或者利用基于蛋白质语言模型嵌入的 K - 中心点聚类进行多样化选择。在模型优化的第一轮，需要决定如何选择变体。随机选择变体是一种简单直接的方式，而基于 K - 中心点聚类的多样化选择则试图通过聚类算法，从蛋白质语言模型生成的嵌入向量中选择更具多样性的变体，为后续轮次的优化提供更丰富的起始点。  

**学习策略。** **随机选择。** 在后续轮次中，随机选择变体，这是一种简单的、不依赖模型预测或其他复杂规则的选择方式，用于对比其他更具针对性的选择策略。**选择预测适应度最高的前 n 个变体。** 基于模型预测的适应度值，挑选出排名靠前的 n 个变体，旨在直接关注模型认为最有潜力的变体，以快速提升整体适应度。**选择预测适应度最高的前 n/2 个变体和最低的后 n/2 个变体。** 这种策略不仅关注高适应度变体，还纳入低适应度变体，希望通过同时探索两个极端，更全面地了解适应度景观，可能有助于发现一些隐藏的规律或避免陷入局部最优。**选择与先前选择的变体在欧几里得嵌入距离上最大的变体。** 该策略侧重于选择与之前所选变体在特征空间（通过欧几里得距离衡量）中距离较远的变体，以增加选择的多样性，探索模型未充分覆盖的区域。  

**嵌入类型。** 文中比较了不同的嵌入表示，包括原始嵌入，以及主成分分析（PCA）降维后的嵌入（维度从 10 到 1000），以适应高维度（p）、低样本量（n）的模式。这一过程完全在最大的（150 亿参数）ESM2 模型上进行。由于数据集可能具有高维度特征但样本量相对较少，不同的嵌入方式可能会影响模型对数据的理解和处理能力。原始嵌入保留了数据的原始特征表示，而 PCA 降维后的嵌入通过提取主要成分来降低维度，在减少计算量的同时可能保留关键信息，不同的降维维度也会产生不同效果，通过比较来确定最适合的嵌入类型。  

**回归类型。** 文中评估了多种用于适应度预测的回归模型，包括岭回归、套索回归、弹性网络回归、线性回归、具有线性最后一层的神经网络、随机森林回归、K 近邻回归、高斯过程回归和梯度提升回归。这些模型大多使用默认参数。不同的回归模型对数据的拟合方式和捕捉复杂关系的能力不同，在适应度预测任务中可能会有不同表现。通过使用默认参数进行评估，可以在相对统一的条件下比较各模型的性能，找出最适合该任务的回归模型。

对于每个参数组合，文中运行了三次模拟（以改变第一轮选择的变体），每轮使用 16 个变体来考虑随机变异性。性能评估使用更新后的模型预测的前 16 个变体中高适应度变体的比例。文中通过统计每个参数值在多少个数据集中实现了最高的平均适应度二元百分比来量化每个参数值的整体有效性。这个 “获胜策略” 计数提供了一个简单而有用的总结，即哪些方法在不同的蛋白质系统中最为成功。“获胜策略” 是第一轮随机选择、原始适应度、前 n 选择、随机森林回归和原始嵌入。通过多次模拟和对不同数据集的评估，确定了在不同蛋白质系统中相对最优的参数组合，即 “获胜策略”，为后续的模型优化和应用提供了参考依据。多次模拟可以减少随机因素对结果的影响，使评估结果更具可靠性。**通过统计在多个数据集上的表现来确定最优策略，能更好地适应不同类型的蛋白质系统。**

## 结果
### EVOLVEpro 模型的开发与基准测试。
**（1）EVOLVEpro 模型框架概述。** 基于深度学习的定向进化框架 EVOLVEpro 结合了：（i）一个蛋白质语言模型（PLM），将蛋白质序列编码到一个连续的潜在空间中，以促进活性优化；（ii）一个顶层回归模型，从少量数据点中学习潜在空间与活性之间的映射关系。EVOLVEpro 在多轮进化中主动学习适应度景观。在每一轮中，回归模型根据预测的活性对蛋白质序列进行排序，选择排名靠前的序列进行实验验证。反复执行这些循环，以提高特定蛋白质的活性，直到达到期望水平（图 1A）。这里阐述了 EVOLVEpro 的核心组成部分，PLM 用于对蛋白质序列进行编码，顶层回归模型则建立潜在空间与活性的联系，通过多轮迭代优化蛋白质活性。  

![](EVOLVEpro蛋白质语言模型驱动的快速定向进化/EVOLVEpro蛋白质语言模型驱动的快速定向进化_2025-02-01-23-40-48.png)  
