# Gromacs进行共价体系蛋白配体动力学模拟：蛋白使用pdb2gmx charmm36，共价小分子使用swissparm
分子动力学模拟（MD模拟）作为一种强有力的计算工具，已广泛应用于生物分子研究中，尤其是在蛋白质-配体相互作用的研究中。对于共价体系，蛋白质和配体之间的结合不仅是非共价相互作用的简单叠加，更涉及到共价键的形成与断裂，这使得常规的非共价模拟方法无法充分捕捉其细节。因此，为共价小分子配体生成合适的力场参数并进行准确的动力学模拟，成为了研究共价抑制剂、设计新药和探索化学反应机制的核心挑战。

在这方面，GROMACS与SwissParam的结合提供了一个强大且高效的解决方案。GROMACS作为世界领先的分子动力学模拟软件，其优秀的性能和灵活的功能，使得它成为进行蛋白质-配体动力学模拟的理想选择。而SwissParam，则为共价小分子配体提供了自动化的力场参数化功能，特别适用于处理涉及共价结合的复杂体系。通过将GROMACS中的pdb2gmx模块与CHARMM36力场相结合，我们能够为蛋白质生成稳定的结构和准确的力场描述；而使用SwissParam为共价小分子配体生成专门的参数，可以有效模拟配体与蛋白质之间的共价反应过程。

之前文章 []() 介绍了NAMD进行共价体系模拟。本文仍以PDBid：5VBM为例将重点介绍如何在GROMACS平台上进行共价体系的蛋白-配体动力学模拟，利用CHARMM36为蛋白质提供强大的力场支持，同时使用SwissParam为共价小分子配体生成定制的力场参数。通过这一过程，我们可以深入了解共价抑制剂在蛋白质活性位点的作用机制，为药物设计、分子优化及新疗法的探索提供科学依据。

## 使用SwissParam产生共价配体92V的MMFF力场参数itp文件
示例PDBid：5VBM中共价配体92V中的原子S24与蛋白的CYS残基形成了二硫键。  
![](Gromacs进行共价体系蛋白配体动力学模拟蛋白使用pdb2gmxcharmm36共价小分子使用swissparm/Gromacs进行共价体系蛋白配体动力学模拟蛋白使用pdb2gmxcharmm36共价小分子使用swissparm_2025-01-23-11-39-14.png)  

首先准备输入的mol2格式文件。如下图所示，mol2文件是在配体的基础上向外延申了二硫键以及一个碳原子。其中向外延申的CYS残基部分的原子名称需要和残基中的原子名称一致。  
![](Gromacs进行共价体系蛋白配体动力学模拟蛋白使用pdb2gmxcharmm36共价小分子使用swissparm/Gromacs进行共价体系蛋白配体动力学模拟蛋白使用pdb2gmxcharmm36共价小分子使用swissparm_2025-01-23-11-40-28.png)  

反应的配体原子名称是S24。反应类型是形成二硫键反应。形成共价的残基是CYS。输入结构文件的结构是共价反应后的结构。所以使用下述命令准备共价配体参数。该方式形成的力场参数是MMFF的。   
```shell
$ curl -s -F "myMol2=@92V.mol2" "swissparam.ch:5678/startparam?ligsite=S24&reaction=disulf_form&protres=CYS&topology=post-cap"
```

生成的文件如下所示。92V是含有二硫键以及延申的碳原子的结构的力场文件，post是反应后的配体部分的结构以及力场文件，pre是单单配体部分反应前的结构以及力场文件。  
![](Gromacs进行共价体系蛋白配体动力学模拟蛋白使用pdb2gmxcharmm36共价小分子使用swissparm/Gromacs进行共价体系蛋白配体动力学模拟蛋白使用pdb2gmxcharmm36共价小分子使用swissparm_2025-01-23-11-41-13.png)  

上述生成的post.pdb文件和post.itp文件是后续建模所需文件。  
## pdb2gmx产生共价反应后蛋白的拓扑与力场
共价反应中蛋白残基与配体发生了化学反应形成了共价键。经由化学反应配体中因形成共价键会丢失一些原子，上述SwissParam产生的post.pdb和post.itp是反应后的配体结构和力场参数。现在也需要获得蛋白部分共价反应后的结构和力场参数。  

以此例为例，其中的CYS残基因形成二硫键应该会丢失一个氢原子。为准备蛋白反应后的结构和拓扑，首先可以使用pdb2gmx -ignh对蛋白自动加氢获取完整加氢后的蛋白结构和拓扑，后续则需要修改蛋白结构文件和拓扑文件，删除其中多余的原子并构建共价键和共价所需的键，键角，二面角等参数。  
```shell
echo 2|gmx pdb2gmx -f complex.pdb -o build.pdb -water tip3p -ignh   # 2就是charmm36力场
```
## 修改拓扑文件构建共价结构和力场参数（键，键角，二面角等参数）

## 准备em，nvt，npt和prod的mdp文件
## 跑模拟的脚本文件
## 模拟所需文件的整体构成 